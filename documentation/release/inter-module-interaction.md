# Межмодульное взаимодействие

## Модули

### 1. Модуль `application`
- **Функции:**
  - `joinGame(gameId: string, userId: string)`: Позволяет пользователю присоединиться к игре.
  - `leaveGame(gameId: string, userId: string)`: Позволяет пользователю покинуть игру.
  - `markPayment(gameId: string, userId: string)`: Отмечает оплату для подтвержденного участника.
  - `createGame(data)`: Создает новую игру с заданными параметрами.
  - `closeGame(gameId: string)`: Закрывает игру.

### 2. Модуль `domain`
- **Функции:**
  - `Game`: Класс, представляющий игру.
  - `Registration`: Класс, представляющий регистрацию игрока.

### 3. Модуль `infrastructure`
- **Функции:**
  - `PrismaGameRepo`: Реализация репозитория для работы с играми через Prisma.
  - `PrismaRegistrationRepo`: Реализация репозитория для работы с регистрациями через Prisma.

### 4. Модуль `shared`
- **Функции:**
  - `eventPublisher`: Публикует события, связанные с изменениями в системе.

## Взаимодействие между модулями

- **`application`** взаимодействует с **`domain`** для работы с играми и регистрациями.
- **`application`** использует репозитории из **`infrastructure`** для доступа к данным.
- Все модули используют **`shared`** для публикации событий, что позволяет отслеживать изменения в системе. Это обеспечивает асинхронное взаимодействие между компонентами и позволяет легко добавлять новые модули в будущем.
- Каждый модуль имеет четко определенные функции и интерфейсы, что упрощает их тестирование и замену. Например, модуль `application` взаимодействует с `domain` для управления играми и регистрациями, а также использует репозитории из `infrastructure` для доступа к данным.
- Взаимодействие между модулями происходит через события, которые публикуются и обрабатываются в реальном времени, что позволяет системе оставаться отзывчивой и масштабируемой.

## Примеры использования

```javascript
// Пример создания игры
const newGame = await createGame({
  organizerId: 'user123',
  venueId: 'venue456',
  startsAt: new Date('2025-12-01T10:00:00Z'),
  capacity: 20,
  levelTag: 'beginner',
  priceText: '1000'
});